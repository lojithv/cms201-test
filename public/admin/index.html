<h1>hello sunshine admin!</h1>

<script>
  async function postJson(e) {
    event.preventDefault();
    const form = e.target;
    const body = form.querySelector('textarea').value.trim();
    const res = await fetch(form.action, { method: "POST", headers: { 'Content-Type': 'application/json' }, body });
    const text = await res.text();
    console.log(res.status, text);
  }
</script>

<ol>
  <lh>All the entries of /data/files.json</lh>
  <script>
    const ol = document.currentScript.parentElement;
    async function main() {
      const resp = await fetch('/data/files.json');
      if (!resp.ok)
        return console.log('No /data/files.json yet');
      const files = await resp.json();
      for (const file of files)
        ol.insertAdjacentHTML('beforeend',
          `<li><a href="/data/${file}" target="_blank">/data/${file}</a></li>`);
    }
    main();
  </script>
</ol>

<lh>Simple steps</lh>
<li><a href="/" target="_blank">Back to main</a></li>
<li><a href="/auth/checkLogin" target="_blank">check login</a></li>
<li><a href="/auth/logout" target="_blank">logout</a></li>
<lh>POST check content of console.log</lh>

<lh>uploads</lh>
<li>/api/addEvent
  <form method="POST" action="/api/addEvent" onsubmit="postJson(event)">
    <textarea name="events" rows="10" cols="50">
      { "bob": { "one": 1, "two": 2} }
    </textarea>
    <br>
    <button>addEvent</button>
  </form>
</li>
<li>/api/addFile
  <form method="POST" action="/api/addFile" enctype="multipart/form-data">
    <input type="file" name="file" required>
    <br>
    <input type="text" name="filename" placeholder="Optional filename">
    <br>
    <input type="text" name="contentType" placeholder="Optional content type">
    <br>
    <button>addFile</button>
  </form>
</li>

<lh>GET events</lh>
<li><a href="/api/events" target="_blank">/api/events</a></li>
<li><a href="/api/events/2" target="_blank">/api/events/2</a></li>

<lh>GET start GITHUB backup (only in production)</lh>
<li><a href="/api/backup" target="_blank">backup</a></li>