<head>
  <style csss=""></style>
  <script src="https://cdn.jsdelivr.net/gh/orstavik/doubledots@main25.05.13.13/dd.js"></script>
  <script type="module"
    src="https://cdn.jsdelivr.net/gh/orstavik/doubledots@main25.05.13.13/ddx.js?fetch_json&oi.~&embrace&Submit&Csss&Class&NAV&STATE~~&Click"
    _:define></script>
  <script type="module" src="/reactions.js"></script>
  <script>
    window.addEventListener("message", function(e) {
      if (location.origin !== e.origin) 
        return;
      const {data, type} = e.data;
      if (type === "image") {
        const {imageURL, key} = data;
        const input = document.querySelector(`input[name="${key}"]`);
        input.value = imageURL;
        input.nextElementSibling.src = imageURL;
      }
      if (type === "references") {
        const {references, key} = data;
        const input = document.querySelector(`input[name="${key}"]`);
        input.value = JSON.stringify(references);
        const container = document.querySelector(`#${key}`);
        container.innerHTML = references.map(reference => `<li>${reference}</li>`).join("\n");
      }
    })
  </script>
</head>
<body class="$palette(#4f46e5) $flex(cc) $bg(#f9fafb)" 
  _::fetch_json:oi.value:er:state_snaps="/api/snap"
  nav:get-id:state_id
  state_snaps_id:get-post-with-relation:state_post
>
  <div template: style="box-shadow:0 4px 6px rgba(0, 0, 0, 0.1)" class="$w(min,100%,700px) $h(min) $bg(white) $padding(2rem) $font(helvetica,arial,'sans-serif',500,capitalize)" 
    state_post:add-post-key:show-post:embrace
  >
    <h1 class="$block(c) $color(--primary,--primary)">Edit Post</h1>
    <form post="{{JSON.stringify(post)}}" submit:prevent-default:formdata-json:form-diff:parse-relation:edit-post:alert class="$flex(column,gap(1rem))">
          <!-- <template for="key of keys"> -->
            <div class="|label$fontWeight(bold) |input,textarea$w(,100%,)$padding(.7rem)$margin(.5rem,0,0,0)$borderColor(#d1d5db)$border(solid,1px,radius(6px))">
              <!-- <template if="key === 'text'"> -->
              <label for="{{$key}}">{{$key}}</label>
              <input type="{{key}}" name="{{$key}}" value="{{post[$key]}}" />
              <!-- </template> -->
              <!-- <template if="key === 'url'"> -->
                <!-- <template if="$key === 'thumbnail'"> -->
                  <label for="{{$key}}">{{$key}}</label>
                  <input type="{{key}}" name="{{$key}}" value="{{post[$key]}}" />
                  <img src="{{post[$key]}}" width="300" height="300" />
                  <a href="/imageSelector?key={{$key}}" click:select-in-other-tab>Select Image</a>
                <!-- </template> -->
                <!-- <template if="$key === 'logo'"> -->
                  <label for="{{$key}}">{{$key}}</label>
                  <input type="{{key}}" name="{{$key}}" value="{{post[$key]}}" />
                  <img src="{{post[$key]}}" width="300" height="300" />
                  <a href="/imageSelector?key={{$key}}" click:select-in-other-tab>Select Image</a>
                <!-- </template> -->
                <!-- <template if="$key === 'img'"> -->
                  <label for="{{$key}}">{{$key}}</label>
                  <input type="{{key}}" name="{{$key}}" value="{{post[$key]}}" />
                  <img src="{{post[$key]}}" width="300" height="300" />
                  <a href="/imageSelector?key={{$key}}" click:select-in-other-tab>Select Image</a>
                <!-- </template> -->
              <!-- </template> -->
              <!-- <template if="key === 'date'"> -->
              <label for="{{$key}}">{{$key}}</label>
              <input type="{{key}}" name="{{$key}}" value="{{post[$key]}}" />
              <!-- </template> -->
              <!-- <template if="key === 'textmd'"> -->
              <label for="{{$key}}">{{$key}}</label>
              <textarea type="{{key}}" name="{{$key}}" value="{{post[$key]}}" rows="10">{{post[$key]}}</textarea>
              <!-- </template> -->
              <!-- <template if="key === 'relation'"> -->
              <label for="{{$key}}">{{$key}}:</label>
              <input type="hidden" name="{{$key}}" value="{{JSON.stringify(post[$key])}}" references/>
              <ul id="{{$key}}">
                <!-- <template for="value of post[$key]"> -->
                  <li>{{value}}</li>
                  <!-- template> -->
                </ul>
              <a href="/listSelector?post={{post.uid}}&key={{$key}}" click:select-in-other-tab class="$em(0.9rem)">select reference</a>
              <!-- </template> -->
            </div>
          <!-- </template> -->
        <input type="submit" value="Save Edit" class="$padding(.8rem) $cursor(pointer) $bg(--primary) $color(white,white) $em(.9rem) $border(solid,1px,radius(6px))">
    </form>
  </div>
</body>